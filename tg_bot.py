import telebot
from telebot import types

from google_sheets import get_total_revenue, add_row
from settings import TG_TOKEN, SHEET_URL
from utils import create_batton
#–û–±—ä–µ–∫—Ç - –±–æ—Ç
bot = telebot.TeleBot(TG_TOKEN, parse_mode=None) #TG_TOKEN –∏–∑ —Ñ–∞–π–ª–∞ settings
# Best Practis: –µ—Å–ª–∏ –º—ã –¥–µ–ª–∞–µ–º —á—Ç–æ-—Ç–æ –æ–¥–∏–Ω–∞–∫–æ–≤–æ–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑, —Ç–æ –æ—Ç –Ω–µ–≥–æ –Ω—É–∂–Ω–æ –∏–∑–±–∞–≤–ª—è—Ç—å—Å—è
#—Å–æ–∑–¥–∞—ë–º –∫–Ω–æ–ø–∫–∏ —Ñ—É–Ω–∫—Ü–∏–µ–π –æ–±—â–µ–≥–æ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è create_batton –∏–∑ —Ñ–∞–π–ª–∞ utils, —á—Ç–æ–±—ã –Ω–µ –¥—É–±–ª–∏—Ä–æ–≤–∞—Ç—å –æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ –∫–æ–¥ –≤ —Ä–∞–∑–Ω—ã—Ö –º–µ—Å—Ç–∞—Ö.
BTN_DOC = create_batton('doc', 'üìù –ü–æ–∫–∞–∑–∞—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç')
BTN_REV = create_batton('rev','üí≤ –û–±—â–∞—è –≤—ã—Ä—É—á–∫–∞')
BTN_NEW_ITEM = create_batton('new_item', '‚úÖ –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–¥–∞–∂—É')
BTN_CANCEL = create_batton('cancel', '‚ùå –ó–∞–∫—Ä—ã—Ç—å inline-–∫–ª–∞–≤–∏–∞—Ç—É—Ä—É')

#–§—É–Ω–∫—Ü–∏—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤–æ–π –ø—Ä–æ–¥–∞–∂–∏
def add_new_item(message): #–ü—Ä–∏–Ω–∏–º–∞–µ—Ç –æ–±—ä–µ–∫—Ç —Å–æ–æ–±—â–µ–Ω–∏—è
    new_item = [message.from_user.first_name] #—Å–Ω–∞—á–∞–ª–∞ —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç —Å–ø–∏—Å–æ–∫ –∑–Ω–∞—á–µ–Ω–∏–π, –≥–¥–µ –ø–µ—Ä–≤—ã–º –∑–Ω–∞—á–µ–Ω–∏–µ–º –±—É–¥–µ—Ç first_name user'–∞ - –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—è —Å–æ–æ–±—â–µ–Ω–∏—è
    msg = bot.send_message(message.chat.id, '–í–≤–µ–¥–∏—Ç–µ –æ–±—ä–µ–∫—Ç') #–±–æ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ '–í–≤–µ–¥–∏—Ç–µ –æ–±—ä–µ–∫—Ç', –∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º –º–µ—Ç–æ–¥–∞ send_message –±—É–¥–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –Ω–∞–ø–∏—à–µ—Ç user, —Å–æ—Ö—Ä–∞–Ω—è–µ–º –µ–≥–æ –≤ msg
    bot.register_next_step_handler(msg, add_title, new_item=new_item) #–ú–µ—Ç–æ–¥ bot.register_next_step_handler —Ä–∞–±–æ—Ç–∞—Ç–µ—Ç —Å –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é —à–∞–≥–æ–≤, –∫–æ—Ç–æ—Ä—ã–π —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç —Å–ª–µ–¥—É—é—â–∏–π —à–∞–≥ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞.
    #–û–Ω –±—É–¥–µ—Ç –∂–¥–∞—Ç—å –æ—Ç user'–∞ —Å–æ–æ–±—â–µ–Ω–∏–µ, –∫–∞–∫ —Ç–æ–ª—å–∫–æ –æ–Ω –µ–≥–æ –æ—Ç–ø—Ä–∞–≤–∏—Ç, –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏—è add_title (—Å–º.–Ω–∏–∂–µ), —Ç–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º –º–µ—Ç–æ–¥ bot.register_next_step_handler –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ user'–∞, –ø—Ä–∏ –µ–≥–æ –ø–æ–ª—É—á–µ–Ω–∏–∏
    #–∑–∞–ø—É—Å–∫–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏—é add_title, –∏ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –≤ –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä new_item —Å–ø–∏—Å–æ–∫ new_item, –≤ –∫–æ—Ç–æ—Ä—ã–π –¥–∞–ª–µ–µ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—Å—è –¥–∞–Ω–Ω—ã–µ

#–§—É–Ω–∫—Ü–∏—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–∞–∑–≤–∞–Ω–∏—è –æ–±—ä–µ–∫—Ç–∞
def add_title(message, **kwargs): #–ü—Ä–∏–Ω–∏–º–∞–µ—Ç –æ–±—ä–µ–∫—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –∏ kwargs - –≤—Å–µ –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã, –∫–æ—Ç. –º—ã —É–∫–∞–∑—ã–≤–∞–µ–º –≤ –º–µ—Ç–æ–¥–µ bot.register_next_step_handler –ø—Ä–µ–¥—ã–¥—É—â–µ–π —Ñ—É–Ω–∫—Ü–∏–∏ - new_item
    new_item = kwargs.get('new_item', []) #–ü–æ–ª—É—á–∞–µ–º —Å–ø–∏—Å–æ–∫ new_item, –∫–æ—Ç. –±—ã–ª —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω –≤ def add_new_item
    new_item.append(message.text) #–ó–∞—Ç–µ–º –¥–æ–±–∞–≤–ª—è–µ–º —Ç–µ–∫—Å—Ç –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è user'–∞ - –≤–≤–µ–¥—ë–Ω–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞ –≤ –æ—Ç–≤–µ—Ç –Ω–∞ '–í–≤–µ–¥–∏—Ç–µ –æ–±—ä–µ–∫—Ç' –≤ —Ñ—É–Ω–∫—Ü–∏–∏ add_new_item
    msg = bot.send_message(message.chat.id, '–í–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É –≤—ã—Ä—É—á–∫–∏') #–±–æ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ '–í–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É –≤—ã—Ä—É—á–∫–∏', –∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º –º–µ—Ç–æ–¥–∞ send_message –±—É–¥–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –Ω–∞–ø–∏—à–µ—Ç user, —Å–æ—Ö—Ä–∞–Ω—è–µ–º –µ–≥–æ –≤ msg
    bot.register_next_step_handler(msg, add_revenue, new_item=new_item) #–∑–∞–ø—É—Å—Ç–∏—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏—è add_revenue (—Å–º.–Ω–∏–∂–µ), —Ç–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º –º–µ—Ç–æ–¥ bot.register_next_step_handler –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ user'–∞, –ø—Ä–∏ –µ–≥–æ –ø–æ–ª—É—á–µ–Ω–∏–∏
    #–∑–∞–ø—É—Å–∫–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏—é add_revenue, –∏ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –≤ –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä new_item —Å–ø–∏—Å–æ–∫ new_item, –≤ –∫–æ—Ç–æ—Ä—ã–π –¥–∞–ª–µ–µ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—Å—è –¥–∞–Ω–Ω—ã–µ

#–§—É–Ω–∫—Ü–∏—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –°—É–º–º—ã –≤—ã—Ä—É—á–∫–∏
def add_revenue(message, **kwargs): #–ü—Ä–∏–Ω–∏–º–∞–µ—Ç –æ–±—ä–µ–∫—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –∏ kwargs - –≤—Å–µ –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã, –∫–æ—Ç. –º—ã —É–∫–∞–∑—ã–≤–∞–µ–º –≤ –º–µ—Ç–æ–¥–µ bot.register_next_step_handler –ø—Ä–µ–¥—ã–¥—É—â–µ–π —Ñ—É–Ω–∫—Ü–∏–∏ - new_item
    new_item = kwargs.get('new_item', []) #–ü–æ–ª—É—á–∞–µ–º —Å–ø–∏—Å–æ–∫ new_item, –∫–æ—Ç. –±—ã–ª —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω –≤ def add_title
    new_item.append(message.text) #–ó–∞—Ç–µ–º –¥–æ–±–∞–≤–ª—è–µ–º —Ç–µ–∫—Å—Ç –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è user'–∞ - –≤–≤–µ–¥—ë–Ω–Ω—É—é —Å—É—Å–º–º—É –≤—ã—Ä—É—á–∫–∏ –≤ –æ—Ç–≤–µ—Ç –Ω–∞ '–í–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É –≤—ã—Ä—É—á–∫–∏' –≤ —Ñ—É–Ω–∫—Ü–∏–∏ add_title
    add_row(new_item) #–î–∞–ª–µ–µ —Å–ø–∏—Å–æ–∫ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –¥–∞–Ω–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–µ–π –∏–∑ –º–æ–¥—É–ª—è(—Ñ–∞–π–ª–∞) google_sheets - –¥–∞–Ω–Ω—ã–µ —Å–ø–∏—Å–∫–∞ –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –≤ —Ç–∞–±–ª–∏—Ü—É –Ω–∞ Google Sheets
    #–í—ã–∑–æ–≤ inline-–∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã –ø–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤–æ–π –ø—Ä–æ–¥–∞–∂–∏
    markup = types.InlineKeyboardMarkup(row_width=2) #–ø–∞—Ä–∞–º–µ—Ç—Ä row_width - –∫–æ–ª-–≤–æ –∫–Ω–æ–ø–æ–∫ –≤ —Ä—è–¥
    btn1 = types.InlineKeyboardButton(BTN_DOC['text'], callback_data=BTN_DOC['key'])  #callback_data(–¥–∞–Ω–Ω—ã–µ –æ—Ç–≤–µ—Ç–∞) - —ç—Ç–æ —Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ (–∫–ª—é—á —Å–ª–æ–≤–∞—Ä—è –∫–Ω–æ–ø–∫–∏), –∫–æ—Ç. –±—É–¥–µ—Ç –ø–µ—Ä–µ–¥–∞–Ω–æ –≤ –æ–±—ä–µ–∫—Ç —Å–æ–æ–±—â–µ–Ω–∏—è, –∫–æ–≥–¥–∞ user –Ω–∞–∂–º—ë—Ç –∫–Ω–æ–ø–∫—É,
    btn2 = types.InlineKeyboardButton(BTN_REV['text'], callback_data=BTN_REV['key'])      #—ç—Ç–æ —Å–æ–æ–±—â–µ–Ω–∏–µ –±—É–¥–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ —Ñ—É–Ω–∫—Ü–∏–µ–π send_text (—Å–∞–º–∞—è –Ω–∏–∂–Ω—è—è)
    btn3 = types.InlineKeyboardButton(BTN_CANCEL['text'], callback_data=BTN_CANCEL['key'])
    markup.add(btn1, btn2, btn3)

    bot.send_message(message.chat.id, '–°–ø–∞—Å–∏–±–æ üëç. –Ø –¥–æ–±–∞–≤–∏–ª –≤ –æ—Ç—á–µ—Ç –Ω–æ–≤—É—é –ø—Ä–æ–¥–∞–∂—É.',
                     reply_markup=markup) #–≤ reply_markup –ø–µ—Ä–µ–¥–∞—ë–º —Å–æ–∑–¥–∞–Ω—É—é inline-–∫–ª–∞–≤–∏–∞—Ç—É—Ä—É

 #–§—É–Ω–∫—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –Ω–∞–∂–∞—Ç–∏–π –∫–Ω–æ–ø–æ–∫ –Ω–∞ inline-–∫–ª–∞–≤–∏–∞—Ç—É—Ä–µ
@bot.callback_query_handler(func=lambda call: True) #—Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–π –∫–Ω–æ–ø–æ–∫ –Ω–∞ inline-–∫–ª–∞–≤–∏–∞—Ç—É—Ä–µ, —Ç.–µ. –µ—Å–ª–∏ –≤ callback_data inline-–∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã –ø–µ—Ä–µ–¥–∞–Ω –∫–ª—é—á —Å–ª–æ–≤–∞—Ä—è –∫–Ω–æ–ø–∫–∏ - —ç—Ç–æ call: True
def callback_inline(call): #–ø—Ä–∏–Ω–∏–º–∞–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä call, –≤ –∫–æ—Ç–æ—Ä—ã–π –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è –∑–Ω–∞—á–µ–Ω–∏–µ callback_data –∏–∑ –≤—ã–∑–æ–≤–∞ inline-–∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã
    if call.message:
        if call.data == BTN_DOC['key']: #–µ—Å–ª–∏ –Ω–∞–∂–∞—Ç–∞ –∫–Ω–æ–ø–∫–∞ "–ü–æ–∫–∞–∑–∞—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç"
            bot.send_message(call.message.chat.id,
                             f'<a href="{SHEET_URL}">–û—Ç—á—ë—Ç –ø–æ –ø—Ä–æ–¥–∞–∂–∞–º</a>', #–ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Å—Å—ã–ª–∫—É –Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç
                             parse_mode='html')
        elif call.data == BTN_REV['key']: #–µ—Å–ª–∏ –Ω–∞–∂–∞—Ç–∞ –∫–Ω–æ–ø–∫–∞ "–û–±—â–∞—è –≤—ã—Ä—É—á–∫–∞"
            bot.send_message(call.message.chat.id,
                             f'–û–±—â–∞—è –≤—ã—Ä—É—á–∫–∞ = <b>{get_total_revenue()}</b>', #–≤—ã–≤–æ–¥–∏—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –æ –≤—ã—Ä—É—á–∫–µ
                             parse_mode='html')
        elif call.data == BTN_CANCEL['key']: #–µ—Å–ª–∏ –Ω–∞–∂–∞—Ç–∞ –∫–Ω–æ–ø–∫–∞ "–û—Ç–º–µ–Ω–∞",
            bot.edit_message_text(chat_id=call.message.chat.id, #—Ç–æ –º–µ—Ç–æ–¥–æ–º edit_message_text –º–µ–Ω—è–µ–º –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –∏–∑ —Ñ—É–Ω–∫—Ü–∏–∏ add_revenue –Ω–∞ —Ç–æ —á—Ç–æ —É–∫–∞–∑–∞–Ω–æ –≤ –ø–∞—Ä–∞–º–µ—Ç—Ä–µ "text" –Ω–∏–∂–µ
                                  message_id=call.message.message_id,
                                  text="OK üëå", #–Ω–æ–≤—ã–π —Ç–µ–∫—Å—Ç –∏–ª–∏ –º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–ª—è—Ç—å –ø—Ä–µ–¥—ã–¥—É—â–∏–π —Ç–µ–∫—Å—Ç –∏–∑ —Ñ—É–Ω–∫—Ü–∏–∏ add_revenu "–°–ø–∞—Å–∏–±–æ üëç. –Ø –¥–æ–±–∞–≤–∏–ª –≤ –æ—Ç—á–µ—Ç –Ω–æ–≤—É—é –ø—Ä–æ–¥–∞–∂—É."
                                  reply_markup=None)  #—É–¥–∞–ª–∏—Ç—å inline-–∫–ª–∞–≤–∏–∞—Ç—É—Ä—É

 #–§—É–Ω–∫—Ü–∏—è –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è
@bot.message_handler(commands=['start', 'help']) #–æ–±–æ—Ä–∞—á–∏–≤–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é send_welcome –≤ –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä message_handler(–æ–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–æ–æ–±—â–µ–Ω–∏–π),
#–≤ –∫–æ—Ç. –º—ã –ø–µ—Ä–µ–¥–∞–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä commands, –∫–æ—Ç. —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–∏–ø —Ç–µ–∫—Å—Ç.
def send_welcome(message):
    img = open('start.jpg', 'rb') #–ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–∞—è –∫–∞—Ä—Ç–∏–Ω–∫–∞
    bot.send_sticker(message.chat.id, img) #–≤—ã–≤–æ–¥–∏—Ç –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—É—é –∫–∞—Ä—Ç–∏–Ω–∫—É

    markup = types.ReplyKeyboardMarkup(resize_keyboard=True) #–≤—ã–≤–æ–¥–∏—Ç –ø–∞–Ω–µ–ª—å —Å –∫–Ω–æ–ø–∫–∞–º–∏
    btn1 = types.KeyboardButton(BTN_DOC['text'])
    btn2 = types.KeyboardButton(BTN_REV['text'])
    btn3 = types.KeyboardButton(BTN_NEW_ITEM['text'])
    markup.add(btn1, btn2, btn3)
#–ú–µ—Ç–æ–¥ reply_to –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏–µ. –ú—ã –ø—Ä–µ–¥–∞–µ–º 2 –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –≤ —ç—Ç–æ—Ç –º–µ—Ç–æ–¥: —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–µ –Ω—É–∂–Ω–æ –æ—Ç–≤–µ—Ç–∏—Ç—å –∏ —Ç–µ–∫—Å—Ç –Ω–∞—à–µ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è:
    bot.reply_to(message, "–ü—Ä–∏–≤–µ—Ç! –≠—Ç–æ –í–∞—à –ª–∏—á–Ω—ã–π –ø–æ–º–æ—à–Ω–∏–∫. –ß–µ–≥–æ –∏–∑–≤–æ–ª–∏—Ç–µ?", reply_markup=markup)

#–§—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è —Ä–µ–∞–≥–∏—Ä—É–µ—Ç –Ω–∞ –Ω–∞–∂–∞—Ç–∏–µ –∫–Ω–æ–ø–æ–∫ –∏ –ø–µ—Ä–µ–¥–∞—ë—Ç –æ—Ç–≤–µ—Ç—ã –ø–æ —É—Å–ª–æ–≤–∏—è–º
@bot.message_handler(content_types=['text']) #–æ–±–æ—Ä–∞—á–∏–≤–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é send_text –≤ –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä message_handler(–æ–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–æ–æ–±—â–µ–Ω–∏–π),
# –Ω–æ –≤ –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ –º—ã –ø–µ—Ä–µ–¥–∞–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä content_types, –∫–æ—Ç. —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–∏–ø —Ç–µ–∫—Å—Ç (–∫–ª—é—á —Å–ª–æ–≤–∞—Ä—è –∫–Ω–æ–ø–∫–∏).
# –≠—Ç–æ –∑–Ω–∞—á–∏—Ç, —á—Ç–æ –Ω–∞—à–∞ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è send_text –±—É–¥–µ—Ç —Å—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å, –∫–æ–≥–¥–∞ –≤ –±–æ—Ç –±—É–¥–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –ª—é–±–æ–µ —Ç–µ–∫—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ.
def send_text(message): #–§—É–Ω–∫—Ü–∏—è —Ä–µ–∞–≥–∏—Ä—É–µ—Ç –Ω–∞ –Ω–∞–∂–∞—Ç–∏–µ –∫–Ω–æ–ø–æ–∫
#–í —Ç–µ–ª–µ —Å–∞–º–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ –º—ã –ø—Ä–æ–≤–µ—Ä—è–µ–º —á–µ–º—É —Ä–∞–≤–µ–Ω —Ç–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è - –∫–∞–∫–∞—è –Ω–∞–∂–∞—Ç–∞ –∫–Ω–æ–ø–∫–∞?
# –ï—Å–ª–∏ –æ–Ω —Ä–∞–≤–µ–Ω 'üìù –ü–æ–∫–∞–∑–∞—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç', —Ç–æ –≤—ã–∑—ã–≤–∞–µ–º –º–µ—Ç–æ–¥ –±–æ—Ç–∞ send_message. –ú–µ—Ç–æ–¥ send_message –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ.
# –ü–µ—Ä–≤—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä –º–µ—Ç–æ–¥–∞ - ID —á–∞—Ç–∞. –í—Ç–æ—Ä–æ–π –ø–∞—Ä–∞–º–µ—Ç—Ä - —Ç–µ–∫—Å—Ç —Å–∞–º–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è. –¢—Ä–µ—Ç–∏–π –ø–∞—Ä–∞–º–µ—Ç—Ä parse_mode (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π) - —Ä–µ–∂–∏–º –ø–∞—Ä—Å–∏–Ω–≥–∞ —Å–æ–æ–±—â–µ–Ω–∏—è
    if message.text == BTN_DOC['text']: #—Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –µ—Å–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ —Ä–∞–≤–Ω–æ –∫–ª—é—á—É —Å–ª–æ–≤–∞—Ä—è —ç—Ç–æ–π –∫–Ω–æ–ø–∫–∏
        bot.send_message(message.chat.id, f'<a href="{SHEET_URL}">–û—Ç—á—ë—Ç –ø–æ –ø—Ä–æ–¥–∞–∂–∞–º</a>', #–í—ã–≤–æ–¥–∏—Ç —Ç–µ–∫—Å—Ç–æ–≤—É—é —Å—Å—ã–ª–∫—É "–û—Ç—á—ë—Ç –ø–æ –ø—Ä–æ–¥–∞–∂–∞–º" –Ω–∞ —Ñ–∞–π–ª-—Ç–∞–±–ª–∏—Ü—É –≤ Google Sheet
                         parse_mode='html')
    elif message.text == BTN_REV['text']: #—Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –µ—Å–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ —Ä–∞–≤–Ω–æ –∫–ª—é—á—É —Å–ª–æ–≤–∞—Ä—è —ç—Ç–æ–π –∫–Ω–æ–ø–∫–∏
        bot.send_message(message.chat.id,
                         f'–û–±—â–∞—è –≤—ã—Ä—É—á–∫–∞ = <b>{get_total_revenue()}</b>', #–í—ã–≤–æ–¥–∏—Ç —Å—É–º–º—É –û–±—â–∞—è –≤—ã—Ä—É—á–∫–∞ –ø–æ —Ñ—É–Ω–∫—Ü–∏–∏ get_total_revenue
                         parse_mode='html')
    elif message.text == BTN_NEW_ITEM['text']: #—Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –µ—Å–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ —Ä–∞–≤–Ω–æ –∫–ª—é—á—É —Å–ª–æ–≤–∞—Ä—è —ç—Ç–æ–π –∫–Ω–æ–ø–∫–∏
        add_new_item(message) #–û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤–æ–π –ø—Ä–æ–¥–∞–∂–∏ –≤ —Ç–∞–±–ª–∏—Ü—É –Ω–∞ Google Sheets: –∏–º—è user'–∞, –Ω–∞–∑–≤–∞–Ω–∏—è –æ–±—ä–µ–∫—Ç–∞ –∏ —Å—É–º–º—ã –≤—ã—Ä—É—á–∫–∏

